# Code Review Documentation v2

> **–ü—Ä–æ–µ–∫—Ç:** GPX Predictor
> **–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:** 2026-01-24
> **–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2026-01-28
> **–¶–µ–ª—å:** –ü—Ä–∏–≤–µ—Å—Ç–∏ –∫–æ–¥–æ–≤—É—é –±–∞–∑—É –≤ AI-friendly —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ production

---

## –§–∞–∑—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ v2 (–ó–ê–í–ï–†–®–ï–ù–û)

| –§–∞–∑–∞ | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ | –°—Ç—Ä–æ–∫ | –í–µ—Ç–∫–∞ |
|------|------|--------|-------------|-------|-------|
| **Phase 0a** | [phase0a_structure.md](phase0a_structure.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | –ù–µ—Ç | ~50 | `refactor/phase-0a-structure` |
| **Phase 0b** | [phase0b_shared.md](phase0b_shared.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 0a | ~100 | `refactor/phase-0b-shared` |
| **Phase 0c** | [phase0c_hiking.md](phase0c_hiking.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 0b | ~200 | `refactor/phase-0c-hiking` |
| **Phase 0d** | [phase0d_trail_run.md](phase0d_trail_run.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 0b | ~150 | `refactor/phase-0d-trail-run` |
| **Phase 0e** | [phase0e_strava.md](phase0e_strava.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 0b | ~300 | `refactor/phase-0e-strava` |
| **Phase 0f** | [phase0f_gpx_users.md](phase0f_gpx_users.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 0b | ~150 | `refactor/phase-0f-gpx-users` |
| **Phase 1** | [phase1_database.md](phase1_database.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 0a | ~250 | `refactor/phase-1-database` |
| **Phase 2** | [phase2_naming.md](phase2_naming.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 0c, 0d | ~200 | `refactor/phase-2-naming` |
| **Phase 3** | [phase3_calculators.md](phase3_calculators.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 0c | ~150 | `refactor/phase-3-calculators` |
| **Phase 4** | [phase4_bot.md](phase4_bot.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 6 | ~300 | `refactor/phase-4-bot` |
| **Phase 5** | [phase5_repositories.md](phase5_repositories.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 0f, 1 | ~300 | `refactor/phase-5-repositories` |
| **Phase 6** | [phase6_api.md](phase6_api.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 2, 5 | ~200 | `refactor/phase-6-api` |
| **Phase 7** | [phase7_tests.md](phase7_tests.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | –í—Å–µ | ~150 | `refactor/phase-7-tests` |

**–û–±—ä—ë–º v2:** ~2300 —Å—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π ‚úÖ

---

## –§–∞–∑—ã cleanup v2.1 (–ù–û–í–´–ï)

> –°–º. [v2.1_cleanup_plan.md](v2.1_cleanup_plan.md) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π

| –§–∞–∑–∞ | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –°—Ç—Ä–æ–∫ | –í—Ä–µ–º—è |
|------|------|--------|-----------|-------|-------|
| **Phase 8** | [phase8_remove_stubs.md](phase8_remove_stubs.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | üü¢ –ù–∏–∑–∫–∞—è | ~30 | `refactor/phase-8-stubs` |
| **Phase 9** | [phase9_update_imports.md](phase9_update_imports.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | üü¢ –ù–∏–∑–∫–∞—è | ~60 | `refactor/v2` |
| **Phase 10** | [phase10_async_migration.md](phase10_async_migration.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | üü° –°—Ä–µ–¥–Ω—è—è | ~600 | `refactor/phase-10-async` |
| **Phase 11** | [phase11_shared_package.md](phase11_shared_package.md) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | üü° –°—Ä–µ–¥–Ω—è—è | ~50 | `refactor/phase-11-shared` |

**–û–±—ä—ë–º v2.1:** ~840 —Å—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π (~7% –æ—Ç v2)

### –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è v2.1

```
Phase 8 (stubs) ‚îÄ‚ñ∫ Phase 9 (imports) ‚îÄ‚ñ∫ Phase 10 (async) ‚îÄ‚ñ∫ Phase 11 (shared)
     5 –º–∏–Ω            30 –º–∏–Ω              2-4 —á–∞—Å–∞          –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
```

### –ß—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥ production:
- ‚úÖ Phase 8 - —É–±—Ä–∞—Ç—å –ø—É—Ç–∞–Ω–∏—Ü—É —Å–æ stubs
- ‚úÖ Phase 9 - —á–∏—Å—Ç—ã–µ –∏–º–ø–æ—Ä—Ç—ã
- ‚úÖ Phase 10 - –µ–¥–∏–Ω—ã–π async –ø–æ–¥—Ö–æ–¥

### –ß—Ç–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:
- ‚è∏Ô∏è Phase 11 - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä–æ–≤ –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω–æ

**–û–±—â–∏–π –æ–±—ä—ë–º v2 + v2.1:** ~3140 —Å—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```
                    ‚îå‚îÄ‚ñ∫ Phase 1 (Database) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                                          ‚îÇ
Phase 0a ‚îÄ‚ñ∫ Phase 0b ‚îÄ‚î¨‚îÄ‚ñ∫ Phase 0c (hiking) ‚îÄ‚ñ∫ Phase 2 ‚îÄ‚ñ∫ Phase 3 ‚îÄ‚î¨‚îÄ‚ñ∫ Phase 5 ‚îÄ‚ñ∫ Phase 6 ‚îÄ‚ñ∫ Phase 4
                      ‚îÇ                            ‚îÇ               ‚îÇ
                      ‚îú‚îÄ‚ñ∫ Phase 0d (trail_run) ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îÇ
                      ‚îÇ                                            ‚îÇ
                      ‚îú‚îÄ‚ñ∫ Phase 0e (strava) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚îî‚îÄ‚ñ∫ Phase 0f (gpx, users) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ü–æ—Å–ª–µ –≤—Å–µ—Ö —Ñ–∞–∑: Phase 7 (Tests)
```

**–ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:**
- Phase 0c + 0d (hiking –∏ trail_run –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã)
- Phase 0e + 0f (strava –∏ gpx/users –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã)
- Phase 1 –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å Phase 0c-0f

---

## Git —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–µ—Ç–æ–∫
```
refactor/phase-{N}{letter?}-{short-description}
```

### Workflow –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã
```bash
# 1. –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É –æ—Ç main
git checkout main
git pull
git checkout -b refactor/phase-0a-structure

# 2. –†–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ —Ñ–∞–∑–æ–π
# ... –∏–∑–º–µ–Ω–µ–Ω–∏—è ...

# 3. Commit —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
git add .
git commit -m "refactor: phase 0a - create features/ and shared/ structure"

# 4. Merge –≤ main (–ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏)
git checkout main
git merge refactor/phase-0a-structure
git push

# 5. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–¥–∞–ª–∏—Ç—å –≤–µ—Ç–∫—É
git branch -d refactor/phase-0a-structure
```

### Commit message format
```
refactor: phase {N} - {–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ}

- –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
```

---

## –ü—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è

| –î–∞—Ç–∞ | –†–µ—à–µ–Ω–∏–µ |
|------|---------|
| 2026-01-24 | `UserPerformanceProfile` ‚Üí `UserHikingProfile` |
| 2026-01-24 | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `trail_run` –≤–µ–∑–¥–µ (–Ω–µ `run`) |
| 2026-01-24 | –û—Å—Ç–∞–≤–∏—Ç—å 2 –≤–µ—Ä—Å–∏–∏ Naismith (–Ω—É–∂–Ω—ã –¥–ª—è 3 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞—Å—á—ë—Ç–∞) |
| 2026-01-24 | –õ–∏–º–∏—Ç—ã: –°–µ—Ä–≤–∏—Å—ã 500, Routes 400, Models 300, Utils 200 —Å—Ç—Ä–æ–∫ |
| 2026-01-26 | PostgreSQL —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞ (–Ω–µ SQLite) |
| 2026-01-26 | Phase 0 —Ä–∞–∑–±–∏—Ç –Ω–∞ –ø–æ–¥—Ñ–∞–∑—ã 0a-0f |
| 2026-01-26 | Phase 6 (API) –ø–µ—Ä–µ–¥ Phase 4 (Bot) |
| 2026-01-26 | –î–æ–±–∞–≤–ª–µ–Ω–∞ Phase 7 (Tests) |
| 2026-01-26 | –û–¥–Ω–∞ git –≤–µ—Ç–∫–∞ –Ω–∞ —Ñ–∞–∑—É/–ø–æ–¥—Ñ–∞–∑—É |
| 2026-01-28 | v2 –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –¥–æ–±–∞–≤–ª–µ–Ω cleanup v2.1 |
| 2026-01-28 | prediction.py –æ—Å—Ç–∞—ë—Ç—Å—è –≤ services/ (–∫—Ä–æ—Å—Å-—Ñ–∏—á—ë–≤—ã–π) |
| 2026-01-28 | Phase 11 (shared package) –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ |

---

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ñ–∞–∑–∞–º–∏

### –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ñ–∞–∑—ã
1. `git status` ‚Äî –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å—Ç—ã–π
2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª —Ñ–∞–∑—ã —Ü–µ–ª–∏–∫–æ–º
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ‚Äî –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ñ–∞–∑—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã?
4. –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É: `git checkout -b refactor/phase-{N}-{name}`

### –í–æ –≤—Ä–µ–º—è —Ñ–∞–∑—ã
1. –°–ª–µ–¥–æ–≤–∞—Ç—å —á–µ–∫–ª–∏—Å—Ç—É –≤ —Ñ–∞–π–ª–µ —Ñ–∞–∑—ã
2. –ü—Ä–æ–≤–µ—Ä—è—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∫—Ä—É–ø–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. –ö–æ–º–º–∏—Ç–∏—Ç—å –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–∏ (–Ω–µ –æ–¥–∏–Ω –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–π –∫–æ–º–º–∏—Ç)

### –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ñ–∞–∑—ã
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
   ```bash
   cd backend && uvicorn app.main:app --reload
   # –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
   cd bot && python main.py
   ```
2. –û—Ç–º–µ—Ç–∏—Ç—å ‚úÖ –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã –≤ —Ñ–∞–π–ª–µ —Ñ–∞–∑—ã
3. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤ —ç—Ç–æ–º README
4. Merge –≤ main
5. –û–±–Ω–æ–≤–∏—Ç—å CLAUDE.md –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã

```bash
# Backend
cd backend
pip install -r requirements.txt  # –µ—Å–ª–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
uvicorn app.main:app --reload

# Bot (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd bot
python main.py

# Tests (–ø–æ—Å–ª–µ Phase 7)
cd backend
pytest tests/ -v
```

---

*Last updated: 2026-01-28*
