# –§–∞–∑–∞ 2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è —Ç—É—Ä–∏—Å—Ç–æ–≤

**–¶–µ–ª—å:** –ë–∞–∑–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤, –≥—Ä—É–ø–ø–æ–≤—ã–µ –ø–æ—Ö–æ–¥—ã, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram

---

## –®–∞–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –®–∞–≥ 1: –ë–∞–∑–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –ê–ª–º–∞—Ç—ã
- –ö–æ–∫-–ñ–∞–π–ª—è—É, –ë—É—Ç–∞–∫–æ–≤—Å–∫–∏–π, –ë–ê–û, –§—É—Ä–º–∞–Ω–æ–≤–∞
- –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ GPX
- –§–æ—Ç–æ –∏ –æ–ø–∏—Å–∞–Ω–∏—è

### –®–∞–≥ 2: –ì—Ä—É–ø–ø–æ–≤–æ–π –ø—Ä–æ–≥–Ω–æ–∑ (–£–¢–ü!)
- –í–≤–æ–¥ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥—Ä—É–ø–ø—ã
- –†–∞—Å—á—ë—Ç spread –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- –¢–æ—á–∫–∏ –≤—Å—Ç—Ä–µ—á–∏
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é –≥—Ä—É–ø–ø—ã
- **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–ø—ã—Ç–∞ –¥—Ä—É–∑—å—è–º–∏** ‚Äî –∞–Ω–æ–Ω–∏–º–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

### –®–∞–≥ 3: Telegram Mini App
- Telegram Web App setup
- Adapted UI –¥–ª—è —Ç—É—Ä–∏—Å—Ç–æ–≤
- –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–ª–∞–Ω–∞ –≤ —á–∞—Ç

### –®–∞–≥ 4: –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –ö–Ω–æ–ø–∫–∞ "–°–æ–æ–±—â–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç –±–ª–∏–∑–∫–∏–º"
- QR-–∫–æ–¥ —Å –ø–ª–∞–Ω–æ–º –ø–æ—Ö–æ–¥–∞
- –§–æ—Ä–º–∞—Ç –¥–ª—è –î–ß–° (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## Deliverables

- [ ] –ë–∞–∑–∞ 10+ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –ê–ª–º–∞—Ç—ã
- [ ] –ì—Ä—É–ø–ø–æ–≤–æ–π –ø—Ä–æ–≥–Ω–æ–∑ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
- [ ] Telegram Mini App –≤–µ—Ä—Å–∏—è
- [ ] –§—É–Ω–∫—Ü–∏—è "–°–æ–æ–±—â–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç –±–ª–∏–∑–∫–∏–º"

---

## –£–¢–ü: –ì—Ä—É–ø–ø–æ–≤–æ–π –ø—Ä–æ–≥–Ω–æ–∑

### –ü—Ä–æ–±–ª–µ–º–∞

```
–¢–∏–ø–∏—á–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:
‚îú‚îÄ‚îÄ –û–ª–µ–≥ (–æ–ø—ã—Ç–Ω—ã–π, –Ω–∞–ª–µ–≥–∫–µ):     –ø—Ä–æ–≥–Ω–æ–∑ 4 —á–∞—Å–∞
‚îú‚îÄ‚îÄ –ú–∞—Ä–∏–Ω–∞ (–ª—é–±–∏—Ç–µ–ª—å, —Å –¥–µ—Ç—å–º–∏): –ø—Ä–æ–≥–Ω–æ–∑ 7 —á–∞—Å–æ–≤
‚îú‚îÄ‚îÄ –°–∞—à–∞ (–Ω–æ–≤–∏—á–æ–∫, —Ç—è–∂—ë–ª—ã–π —Ä—é–∫–∑–∞–∫): –ø—Ä–æ–≥–Ω–æ–∑ 8 —á–∞—Å–æ–≤
‚îî‚îÄ‚îÄ –ì—Ä—É–ø–ø–∞ –≤—ã—Ö–æ–¥–∏—Ç –≤–º–µ—Å—Ç–µ...

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
‚îú‚îÄ‚îÄ –û–ª–µ–≥ —É–±–µ–≥–∞–µ—Ç –≤–ø–µ—Ä—ë–¥, –∂–¥—ë—Ç, —Å–∫—É—á–∞–µ—Ç
‚îú‚îÄ‚îÄ –ú–∞—Ä–∏–Ω–∞ —Å –¥–µ—Ç—å–º–∏ –æ—Ç—Å—Ç–∞—ë—Ç, –Ω–µ—Ä–≤–Ω–∏—á–∞–µ—Ç
‚îú‚îÄ‚îÄ –°–∞—à–∞ –≤—ã–±–∏–≤–∞–µ—Ç—Å—è –∏–∑ —Å–∏–ª, —Ç—è–Ω–µ—Ç –≤—Å–µ—Ö –Ω–∞–∑–∞–¥
‚îî‚îÄ‚îÄ –í—Å–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ç–µ–º–Ω–æ—Ç–µ, —É—Å—Ç–∞–≤—à–∏–µ –∏ –∑–ª—ã–µ
```

### –ù–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üë• –ü–†–û–ì–ù–û–ó –î–õ–Ø –ì–†–£–ü–ü–´                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –ú–∞—Ä—à—Ä—É—Ç: –ö–æ–∫-–ñ–∞–π–ª—è—É (12 –∫–º, +680–º)                     ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  –£–ß–ê–°–¢–ù–ò–ö–ò                       –ò–Ω–¥–∏–≤–∏–¥.   –°—Ç–∞—Ç—É—Å      ‚îÇ
‚îÇ  üë§ –û–ª–µ–≥ (–æ–ø—ã—Ç–Ω—ã–π, –ª—ë–≥–∫–∏–π)       4:00       üü¢ –ë—ã—Å—Ç—Ä—ã–π  ‚îÇ
‚îÇ  üë§ –ú–∞—Ä–∏–Ω–∞ (–ª—é–±–∏—Ç–µ–ª—å, —Ä–µ–±—ë–Ω–æ–∫)   6:30       üü° –°—Ä–µ–¥–Ω–∏–π  ‚îÇ
‚îÇ  üë§ –°–∞—à–∞ (–Ω–æ–≤–∏—á–æ–∫, —Ç—è–∂—ë–ª—ã–π)      7:30       üî¥ –ú–µ–¥–ª–µ–Ω–Ω—ã–π‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  üìä –ê–ù–ê–õ–ò–ó                                               ‚îÇ
‚îÇ  –ü—Ä–æ–≥–Ω–æ–∑ –¥–ª—è –≥—Ä—É–ø–ø—ã: 7:30 - 8:30                        ‚îÇ
‚îÇ  –†–∞–∑–±—Ä–æ—Å —Å–∫–æ—Ä–æ—Å—Ç–µ–π: –í–´–°–û–ö–ò–ô ‚ö†Ô∏è                          ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚ö†Ô∏è –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:                                        ‚îÇ
‚îÇ  1. –†–∞–∑–¥–µ–ª–∏—Ç—å—Å—è –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã                           ‚îÇ
‚îÇ  2. –ü–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É                           ‚îÇ
‚îÇ  3. –ù–∞–∑–Ω–∞—á–∏—Ç—å —Ç–æ—á–∫–∏ —Å–±–æ—Ä–∞                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ê–ª–≥–æ—Ä–∏—Ç–º

```python
class GroupRole(Enum):
    FAST = "fast"       # –¢–æ–ø 25%
    AVERAGE = "average" # –°—Ä–µ–¥–Ω–∏–µ 50%
    SLOW = "slow"       # –ù–∏–∂–Ω–∏–µ 25%

@dataclass
class GroupMember:
    name: str
    profile: HikerProfile
    individual_time_hours: float
    role: Optional[GroupRole] = None

@dataclass
class GroupPrediction:
    members: List[GroupMember]
    group_time_hours: float
    spread_hours: float
    split_recommended: bool
    subgroups: Optional[List[List[str]]]
    recommendations: List[dict]
    meeting_points: List[dict]


def predict_group_time(
    members: List[GroupMember],
    course: CourseInfo
) -> GroupPrediction:
    """
    –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:
    1. –ì—Ä—É–ø–ø–∞ –∏–¥—ë—Ç —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é —Å–∞–º–æ–≥–æ –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ
    2. –ë–æ–ª—å—à–æ–π —Ä–∞–∑–±—Ä–æ—Å = –±–æ–ª—å—à–µ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
    3. –ü—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ä–∞–∑–±—Ä–æ—Å–µ –ª—É—á—à–µ —Ä–∞–∑–¥–µ–ª–∏—Ç—å—Å—è
    """

    sorted_members = sorted(members, key=lambda m: m.individual_time_hours)

    fastest_time = sorted_members[0].individual_time_hours
    slowest_time = sorted_members[-1].individual_time_hours
    spread = slowest_time - fastest_time

    # Overhead –Ω–∞ –æ–∂–∏–¥–∞–Ω–∏–µ
    waiting_overhead = spread * 0.15
    group_time = slowest_time + waiting_overhead

    # –†–∞–∑–¥–µ–ª—è–µ–º—Å—è –µ—Å–ª–∏ —Ä–∞–∑–±—Ä–æ—Å > 2—á –∏–ª–∏ > 40%
    split_recommended = spread > 2.0 or spread / slowest_time > 0.4

    return GroupPrediction(...)
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é

```python
def _suggest_subgroups(members: List[GroupMember]) -> List[List[str]]:
    """
    –ü—Ä–∏–Ω—Ü–∏–ø—ã:
    - –ú–∏–Ω–∏–º—É–º 2 —á–µ–ª–æ–≤–µ–∫–∞ –≤ –≥—Ä—É–ø–ø–µ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
    - –ü–æ—Ö–æ–∂–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–º–µ—Å—Ç–µ
    - –û–ø—ã—Ç–Ω—ã–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)
    """

    fast = [m for m in members if m.role == GroupRole.FAST]
    average = [m for m in members if m.role == GroupRole.AVERAGE]
    slow = [m for m in members if m.role == GroupRole.SLOW]

    group_a = fast + average[:len(average)//2]
    group_b = slow + average[len(average)//2:]

    return [
        [m.name for m in group_a],
        [m.name for m in group_b]
    ]
```

### –¢–æ—á–∫–∏ –≤—Å—Ç—Ä–µ—á–∏

```python
def _suggest_meeting_points(
    course: CourseInfo,
    members: List[GroupMember]
) -> List[dict]:
    """
    –í—ã–±–∏—Ä–∞–µ—Ç —Ç–æ—á–∫–∏ —Å–±–æ—Ä–∞ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ.

    –ö—Ä–∏—Ç–µ—Ä–∏–∏:
    - –ö–∞–∂–¥—ã–µ 3-4 –∫–º
    - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: —Ä–æ–¥–Ω–∏–∫–∏, –ø–ª–æ—â–∞–¥–∫–∏, —Ä–∞–∑–≤–∏–ª–∫–∏
    - –£—á—ë—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏–±—ã—Ç–∏—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã
    """

    points = []

    for poi in course.points_of_interest:
        if poi.type in ["water", "viewpoint", "junction"]:
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö
            fast_arrival = estimate_arrival(poi.km, members[0])
            slow_arrival = estimate_arrival(poi.km, members[-1])

            points.append({
                "km": poi.km,
                "name": poi.name,
                "type": poi.type,
                "fast_group_arrival": fast_arrival,
                "slow_group_arrival": slow_arrival,
                "wait_time_minutes": (slow_arrival - fast_arrival) * 60
            })

    return points
```

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–ø—ã—Ç–∞ –¥—Ä—É–∑—å—è–º–∏ (Peer Validation)

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ—é–¥–∏ —Å–∫–ª–æ–Ω–Ω—ã –ø–µ—Ä–µ–æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Å–≤–æ–π –æ–ø—ã—Ç. –ù–æ–≤–∏—á–æ–∫ –≥–æ–≤–æ—Ä–∏—Ç "—è –æ–ø—ã—Ç–Ω—ã–π" ‚Üí –ø—Ä–æ–≥–Ω–æ–∑ –∑–∞–Ω–∏–∂–µ–Ω ‚Üí –≥—Ä—É–ø–ø–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ç–µ–º–Ω–æ—Ç–µ.

**–†–µ—à–µ–Ω–∏–µ:** –ê–Ω–æ–Ω–∏–º–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –¥—Ä—É–≥–∏–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –≥—Ä—É–ø–ø—ã.

**Flow:**
```
1. –û–ª–µ–≥ —Å–æ–∑–¥–∞—ë—Ç –ø–æ—Ö–æ–¥, –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ —Å–µ–±–µ
2. –î–æ–±–∞–≤–ª—è–µ—Ç –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É —Å –¥—Ä—É–∑—å—è–º–∏
3. –ú–∞—Ä–∏–Ω–∞ –∏ –°–∞—à–∞ —Ç–æ–∂–µ –æ—Ç–≤–µ—á–∞—é—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ —Å–µ–±–µ
4. –ë–æ—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫–∞–∂–¥–æ–≥–æ:
   "–ö–∞–∫ –≤—ã –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç–µ –æ–ø—ã—Ç –û–ª–µ–≥–∞?" (–∞–Ω–æ–Ω–∏–º–Ω–æ)
5. –ï—Å–ª–∏ –æ—Ü–µ–Ω–∫–∏ —Ä–∞—Å—Ö–æ–¥—è—Ç—Å—è ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –ø—Ä–æ–≥–Ω–æ–∑

–ü—Ä–∏–º–µ—Ä:
‚îú‚îÄ‚îÄ –û–ª–µ–≥ –æ —Å–µ–±–µ: "–û–ø—ã—Ç–Ω—ã–π"
‚îú‚îÄ‚îÄ –ú–∞—Ä–∏–Ω–∞ –æ –Ω—ë–º: "–õ—é–±–∏—Ç–µ–ª—å"
‚îú‚îÄ‚îÄ –°–∞—à–∞ –æ –Ω—ë–º: "–õ—é–±–∏—Ç–µ–ª—å"
‚îî‚îÄ‚îÄ –ò—Ç–æ–≥: –ò—Å–ø–æ–ª—å–∑—É–µ–º "–õ—é–±–∏—Ç–µ–ª—å" (–∫–æ–Ω—Å–µ–Ω—Å—É—Å –¥—Ä—É–∑–µ–π)
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
class PeerValidation(BaseModel):
    target_user_id: str           # –ö–æ–≥–æ –æ—Ü–µ–Ω–∏–≤–∞–µ–º
    validator_user_id: str        # –ö—Ç–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç
    claimed_experience: str       # –ß—Ç–æ –∑–∞—è–≤–∏–ª —Å–∞–º
    validated_experience: str     # –ß—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ –¥—Ä—É–∑—å—è
    is_anonymous: bool = True

def calculate_validated_experience(
    self_assessment: str,
    peer_assessments: List[str]
) -> str:
    """
    –ï—Å–ª–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –¥—Ä—É–∑–µ–π –æ—Ü–µ–Ω–∏–≤–∞—é—Ç –Ω–∏–∂–µ ‚Äî –±–µ—Ä—ë–º –∏—Ö –æ—Ü–µ–Ω–∫—É.
    –ï—Å–ª–∏ –≤—ã—à–µ ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º —Å–∞–º–æ–æ—Ü–µ–Ω–∫—É (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ).
    """
    if not peer_assessments:
        return self_assessment

    # –°—á–∏—Ç–∞–µ–º –º–µ–¥–∏–∞–Ω—É –æ—Ü–µ–Ω–æ–∫ –¥—Ä—É–∑–µ–π
    peer_median = get_median_experience(peer_assessments)

    # –ë–µ—Ä—ë–º –±–æ–ª–µ–µ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—É—é –æ—Ü–µ–Ω–∫—É
    return min_experience(self_assessment, peer_median)
```

---

## API Endpoints

### POST /predict/group

```python
class GroupPredictRequest(BaseModel):
    gpx_file_id: str
    members: List[GroupMemberInput]
    is_round_trip: bool = True

class GroupMemberInput(BaseModel):
    name: str
    experience: ExperienceLevel
    backpack: BackpackWeight
    has_children: bool = False

@router.post("/predict/group")
async def predict_group(request: GroupPredictRequest) -> GroupPrediction:
    pass
```

### POST /share/plan

```python
class SharePlanRequest(BaseModel):
    prediction_id: str
    contacts: List[str]  # Telegram usernames –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω—ã
    message: Optional[str]

@router.post("/share/plan")
async def share_plan(request: SharePlanRequest) -> ShareResult:
    """
    –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–ª–∞–Ω –ø–æ—Ö–æ–¥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º.
    """
    pass
```

---

## –ë–∞–∑–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –ê–ª–º–∞—Ç—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```python
@dataclass
class PopularRoute:
    id: str
    name: str
    description: str
    gpx_file: str
    distance_km: float
    elevation_gain_m: float
    difficulty: str  # easy, medium, hard
    typical_time_hours: float
    photos: List[str]
    warnings: List[str]
    water_points: List[dict]
    best_season: List[str]
```

### –ù–∞—á–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

| –ú–∞—Ä—à—Ä—É—Ç | –î–∏—Å—Ç–∞–Ω—Ü–∏—è | –ù–∞–±–æ—Ä | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|---------|-----------|-------|-----------|
| –ö–æ–∫-–ñ–∞–π–ª—è—É | 12 –∫–º | +680–º | –°—Ä–µ–¥–Ω—è—è |
| –ë—É—Ç–∞–∫–æ–≤—Å–∫–∏–π –≤–æ–¥–æ–ø–∞–¥ | 6 –∫–º | +350–º | –õ—ë–≥–∫–∞—è |
| –ë–ê–û (–ë–æ–ª—å—à–æ–µ –ê–ª–º–∞—Ç–∏–Ω—Å–∫–æ–µ –æ–∑–µ—Ä–æ) | 15 –∫–º | +900–º | –°—Ä–µ–¥–Ω—è—è |
| –ü–∏–∫ –§—É—Ä–º–∞–Ω–æ–≤–∞ | 14 –∫–º | +1200–º | –°–ª–æ–∂–Ω–∞—è |
| –ö–∏–º-–ê—Å–∞—Ä | 8 –∫–º | +500–º | –°—Ä–µ–¥–Ω—è—è |
| –¢—Ä–∏ –±—Ä–∞—Ç–∞ | 10 –∫–º | +600–º | –°—Ä–µ–¥–Ω—è—è |
| –¢–µ—Ä—Ä–∞ | 8 –∫–º | +400–º | –õ—ë–≥–∫–∞—è |
| –ê–ª–º–∞-–ê—Ä–∞—Å–∞–Ω | 10 –∫–º | +550–º | –°—Ä–µ–¥–Ω—è—è |

---

## Telegram Mini App

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tg-mini-app/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Home.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Upload.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Profile.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Result.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Group.tsx
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RouteCard.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MemberInput.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Timeline.tsx
‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ       ‚îî‚îÄ‚îÄ client.ts
‚îî‚îÄ‚îÄ package.json
```

### Telegram Web App API

```typescript
import WebApp from '@twa-dev/sdk';

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const user = WebApp.initDataUnsafe.user;

// –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ —á–∞—Ç
WebApp.sendData(JSON.stringify({
  type: 'hike_plan',
  route: '–ö–æ–∫-–ñ–∞–π–ª—è—É',
  time: '6:30',
  start: '07:00'
}));

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
WebApp.close();
```

---

## –§—É–Ω–∫—Ü–∏—è "–°–æ–æ–±—â–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç –±–ª–∏–∑–∫–∏–º"

### Flow

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑
2. –ù–∞–∂–∏–º–∞–µ—Ç "–°–æ–æ–±—â–∏—Ç—å –±–ª–∏–∑–∫–∏–º"
3. –í–≤–æ–¥–∏—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã (Telegram, —Ç–µ–ª–µ—Ñ–æ–Ω)
4. –°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
üèîÔ∏è –ü–ª–∞–Ω –ø–æ—Ö–æ–¥–∞

–ú–∞—Ä—à—Ä—É—Ç: –ö–æ–∫-–ñ–∞–π–ª—è—É
–£—á–∞—Å—Ç–Ω–∏–∫–∏: –û–ª–µ–≥, –ú–∞—Ä–∏–Ω–∞, –°–∞—à–∞
–í—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞: 07:00
–û–∂–∏–¥–∞–µ–º–æ–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ: 15:30

üìç –¢–æ—á–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞:
‚Ä¢ –°—Ç–∞—Ä—Ç: –ú–µ–¥–µ–æ
‚Ä¢ –ö–º 3: –†–æ–¥–Ω–∏–∫
‚Ä¢ –ö–º 6: –ö–æ–∫-–ñ–∞–π–ª—è—É
‚Ä¢ –§–∏–Ω–∏—à: –ú–µ–¥–µ–æ

‚ö†Ô∏è –ï—Å–ª–∏ –Ω–µ –≤—ã–π–¥—É –Ω–∞ —Å–≤—è–∑—å –¥–æ 18:00 ‚Äî –∑–≤–æ–Ω–∏—Ç–µ!

QR-–∫–æ–¥ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ø–ª–∞–Ω–æ–º: [—Å—Å—ã–ª–∫–∞]
```

### QR-–∫–æ–¥

```python
import qrcode

def generate_plan_qr(prediction_id: str) -> bytes:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç QR-–∫–æ–¥ —Å–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –ø–ª–∞–Ω"""
    url = f"https://predictor.ayda.run/plan/{prediction_id}"
    qr = qrcode.make(url)
    return qr.tobytes()
```
